# ---------------------------
# üß† TrichMind Backend (Node + TypeScript)
# ---------------------------

# 1Ô∏è‚É£ Base Image
FROM node:20-alpine AS base
WORKDIR /app
ENV NODE_ENV=production

# 2Ô∏è‚É£ Install dependencies separately for caching
COPY package*.json ./
RUN npm ci --omit=dev

# 3Ô∏è‚É£ Copy source code
COPY . .

# 4Ô∏è‚É£ Build TypeScript ‚Üí JavaScript
RUN npm run build

# 5Ô∏è‚É£ Expose port
EXPOSE 8080

# 6Ô∏è‚É£ Default startup command
CMD ["node", "dist/server.js"]
